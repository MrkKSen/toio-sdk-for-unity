<!DOCTYPE html><html><head><meta charset="utf-8"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css"><style type="text/css">.markdown-body {padding: 20px 40px;}</style><style type="text/css">/*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
}

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold;
}

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080;
}

.hljs-string,
.hljs-doctag {
  color: #d14;
}

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold;
}

.hljs-subst {
  font-weight: normal;
}

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
}

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal;
}

.hljs-regexp,
.hljs-link {
  color: #009926;
}

.hljs-symbol,
.hljs-bullet {
  color: #990073;
}

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3;
}

.hljs-meta {
  color: #999;
  font-weight: bold;
}

.hljs-deletion {
  background: #fdd;
}

.hljs-addition {
  background: #dfd;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
/*# sourceURL=/Users/yaeda/.nodebrew/node/v14.3.0/lib/node_modules/md-to-pdf/node_modules/highlight.js/styles/github.css*/</style></head>
<body class="markdown-body">
<h1 id="目次">目次</h1>
<ul>
<li><a href="usage_cube.html#1-%E6%A6%82%E8%AA%AC">1. 概説</a></li>
<li><a href="usage_cube.html#2-%E6%97%A2%E5%AD%98toio%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AAtoiojs%E3%81%A8%E3%81%AE%E6%AF%94%E8%BC%83">2. 既存 toio ライブラリ(toio.js)との比較</a></li>
<li><a href="usage_cube.html#3-Cube%E3%82%AF%E3%83%A9%E3%82%B9API">3. Cube クラス API</a> - <a href="usage_cube.html#31-%E5%A4%89%E6%95%B0">3.1. 変数</a> - <a href="usage_cube.html#32-%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF">3.2. コールバック</a> - <a href="usage_cube.html#33-%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89">3.3. メソッド</a><br>

</li>
</ul>
<h1 id="1-概説">1. 概説</h1>
<p>Cube クラスは、toio のコアキューブを操作するための機能が実装されています。<br>
このクラスは、異なる環境向けの実装切り替えが出来るマルチプラットフォーム対応クラスとなっており、
Unity システム上で動くコアキューブ(以下シミュレータ) と 現実のコアキューブ の 2 つの実行環境に対応しています。</p>
<p>シミュレータについては<a href="usage_simulator.html">コチラ</a>のページをご参照下さい。</p>
<p>現実のコアキューブでは、<a href="https://toio.github.io/toio-spec/docs/ble_communication_overview.html">コアキューブの技術仕様(通信仕様)</a>に沿って Unity プログラムから Bluetooth 通信を行う事で、現実のコアキューブを操作します。</p>
<h3 id="realsim-機能表">Real/Sim 機能表</h3>
<p>現在(2020/03/04)、コアキューブのファームウェアバージョンは 2 つです。</p>
<ul>
<li>2.0.0 : 公開時の初期バージョン</li>
<li>2.1.0 : 公開後の初アップデート</li>
</ul>
<p>ToioSDK では、現実に動作するコアキューブクラス(Real 対応)、シミュレータで動作するコアキューブクラス(Sim 対応)の 2 つの内部実装が用意されています。それぞれ内部実装が異なっているため、対応状況に違いがあります。<br>
以下に実装対応表を示します。</p>
<h4 id="ファームウェアバージョン-200">ファームウェアバージョン 2.0.0</h4>
<table>
<thead>
<tr>
<th>機能タイプ</th>
<th>機能</th>
<th>Real 対応状況</th>
<th>Sim 対応状況</th>
</tr>
</thead>
<tbody><tr>
<td>読み取りセンサー</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_id#position-id">Position ID</a></td>
<td>o</td>
<td>o</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_id#standard-id">Standard ID</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td>モーションセンサー</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_sensor#%E6%B0%B4%E5%B9%B3%E6%A4%9C%E5%87%BA">水平検出</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_sensor#%E8%A1%9D%E7%AA%81%E6%A4%9C%E5%87%BA">衝突検出</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td>ボタン</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_button#%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E7%8A%B6%E6%85%8B">ボタンの状態</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td>バッテリー</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_battery#%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E6%AE%8B%E9%87%8F">バッテリー残量</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td>モーター</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_motor#%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1">モーター制御</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_motor#%E6%99%82%E9%96%93%E6%8C%87%E5%AE%9A%E4%BB%98%E3%81%8D%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1">時間指定付きモーター制御</a></td>
<td>o</td>
<td>o</td>
</tr>
<tr>
<td>ランプ</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_light#%E7%82%B9%E7%81%AF-%E6%B6%88%E7%81%AF">点灯・消灯</a></td>
<td>o</td>
<td>o</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_light#%E9%80%A3%E7%B6%9A%E7%9A%84%E3%81%AA%E7%82%B9%E7%81%AF-%E6%B6%88%E7%81%AF">連続的な点灯・消灯</a></td>
<td>o</td>
<td>o</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_light#%E5%85%A8%E3%81%A6%E3%81%AE%E3%83%A9%E3%83%B3%E3%83%97%E3%82%92%E6%B6%88%E7%81%AF">全てのランプを消灯</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_light#%E7%89%B9%E5%AE%9A%E3%81%AE%E3%83%A9%E3%83%B3%E3%83%97%E3%82%92%E6%B6%88%E7%81%AF">特定のランプを消灯</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td>サウンド</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_sound#%E5%8A%B9%E6%9E%9C%E9%9F%B3%E3%81%AE%E5%86%8D%E7%94%9F">効果音の再生</a></td>
<td>o</td>
<td>Δ</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_sound#midi-note-number-%E3%81%AE%E5%86%8D%E7%94%9F">MIDI note number の再生</a></td>
<td>o</td>
<td>o</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_sound#%E5%86%8D%E7%94%9F%E3%81%AE%E5%81%9C%E6%AD%A2">再生の停止</a></td>
<td>o</td>
<td>o</td>
</tr>
<tr>
<td>設定</td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_configuration#ble-%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE%E8%A6%81%E6%B1%82">BLE プロトコルバージョンの要求</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_configuration#%E6%B0%B4%E5%B9%B3%E6%A4%9C%E5%87%BA%E3%81%AE%E3%81%97%E3%81%8D%E3%81%84%E5%80%A4%E8%A8%AD%E5%AE%9A">水平検出のしきい値設定</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_configuration#%E8%A1%9D%E7%AA%81%E6%A4%9C%E5%87%BA%E3%81%AE%E3%81%97%E3%81%8D%E3%81%84%E5%80%A4%E8%A8%AD%E5%AE%9A">衝突検出のしきい値設定</a></td>
<td>o</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/2.0.0/ble_configuration#ble-%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AE%E5%8F%96%E5%BE%97">BLE プロトコルバージョンの取得</a></td>
<td>o</td>
<td>x</td>
</tr>
</tbody></table>
<h4 id="ファームウェアバージョン-210">ファームウェアバージョン 2.1.0</h4>
<table>
<thead>
<tr>
<th>機能タイプ</th>
<th>機能</th>
<th>Real 対応状況</th>
<th>Sim 対応状況</th>
</tr>
</thead>
<tbody><tr>
<td>モーションセンサー</td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_sensor#%E3%83%80%E3%83%96%E3%83%AB%E3%82%BF%E3%83%83%E3%83%97%E6%A4%9C%E5%87%BA">ダブルタップ検出（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_sensor#%E5%A7%BF%E5%8B%A2%E6%A4%9C%E5%87%BA">姿勢検出（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td>モーター</td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_motor#%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AE%E9%80%9F%E5%BA%A6%E6%8C%87%E7%A4%BA%E5%80%A4">モーター制御（指示値範囲変更）</a></td>
<td>o</td>
<td>o</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_motor#%E7%9B%AE%E6%A8%99%E6%8C%87%E5%AE%9A%E4%BB%98%E3%81%8D%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1">目標指定付きモーター制御（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_motor#%E8%A4%87%E6%95%B0%E7%9B%AE%E6%A8%99%E6%8C%87%E5%AE%9A%E4%BB%98%E3%81%8D%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1">複数目標指定付きモーター制御（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_motor#%E5%8A%A0%E9%80%9F%E5%BA%A6%E6%8C%87%E5%AE%9A%E4%BB%98%E3%81%8D%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1">加速度指定付きモーター制御（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_motor#%E7%9B%AE%E6%A8%99%E6%8C%87%E5%AE%9A%E4%BB%98%E3%81%8D%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1%E3%81%AE%E5%BF%9C%E7%AD%94">目標指定付きモーター制御の応答（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td></td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_motor#%E8%A4%87%E6%95%B0%E7%9B%AE%E6%A8%99%E6%8C%87%E5%AE%9A%E4%BB%98%E3%81%8D%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1%E3%81%AE%E5%BF%9C%E7%AD%94">複数目標指定付きモーター制御の応答（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td>設定</td>
<td><a href="https://toio.github.io/toio-spec/docs/ble_configuration#%E3%83%80%E3%83%96%E3%83%AB%E3%82%BF%E3%83%83%E3%83%97%E6%A4%9C%E5%87%BA%E3%81%AE%E6%99%82%E9%96%93%E9%96%93%E9%9A%94%E3%81%AE%E8%A8%AD%E5%AE%9A">ダブルタップ検出の時間間隔の設定（new）</a></td>
<td>x</td>
<td>x</td>
</tr>
</tbody></table>
<br>

<h1 id="2-既存-toio-ライブラリtoiojsとの比較">2. 既存 toio ライブラリ(toio.js)との比較</h1>
<p><a href="https://github.com/toio/toio.js">toio.js</a>は、javascript で書かれた既存の toio ライブラリです。<br>
このライブラリは node.js で作られており、PC 環境で動作します。<br>
scanner、cube の 2 つをクラスを利用してコアキューブを操作します。</p>
<p>以下に toio.js のサンプルコードを示します。</p>
<pre><code class="hljs javascript"><span class="hljs-keyword">const</span> { NearestScanner } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@toio/scanner"</span>);

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// start a scanner to find the nearest cube</span>
  <span class="hljs-keyword">const</span> cube = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> NearestScanner().start();

  <span class="hljs-comment">// connect to the cube</span>
  <span class="hljs-keyword">await</span> cube.connect();

  <span class="hljs-comment">// move cube</span>
  cube.move(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1000</span>);
  <span class="hljs-comment">//         |    |     `--- duration [ms]</span>
  <span class="hljs-comment">//         |    `--------- right motor speed</span>
  <span class="hljs-comment">//          `------------- left motor speed</span>
}

main();</code></pre><p>ToioSDK は toio.js ユーザーでも使いやすいプログラムを目指し、
scanner、cube の 2 つのクラスを使用してコアキューブを操作する仕組みにしました。</p>
<p>以下に、同じ挙動をする本プログラムのサンプルコードを示します。</p>
<pre><code class="hljs C#"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SimpleScene</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Start</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-comment">// start a scanner to find the nearest cube</span>
        <span class="hljs-keyword">var</span> peripheral = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> NearestScanner().Scan();

        <span class="hljs-comment">// connect to the cube</span>
        <span class="hljs-keyword">var</span> cube = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> CubeConnecter().Connect(peripheral);

        <span class="hljs-comment">// move cube</span>
        cube.Move(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1000</span>);
        <span class="hljs-comment">//         |    |     `-- duration [ms]</span>
        <span class="hljs-comment">//         |    `-------- right motor speed</span>
        <span class="hljs-comment">//          `------------ left motor speed</span>
    }
}</code></pre><br>

<h1 id="3-cube-クラス-api">3. Cube クラス API</h1>
<h2 id="31-変数">3.1. 変数</h2>
<pre><code class="hljs c#"><span class="hljs-comment">// 接続したコアキューブのファームウェアバージョン</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> version { <span class="hljs-keyword">get</span>; }

<span class="hljs-comment">// コアキューブの固有識別ID</span>
<span class="hljs-comment">// シミュレータ環境では Cube Prefab のゲームオブジェクト名が ID になります</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// コアキューブのアドレス</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> addr { <span class="hljs-keyword">get</span>; }

<span class="hljs-comment">// コアキューブの接続状態</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> isConnected { <span class="hljs-keyword">get</span>; }

<span class="hljs-comment">// コアキューブのバッテリー状態</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> battery { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// マット上のコアキューブのX座標</span>
<span class="hljs-comment">// コアキューブの中心位置を基準とした座標となっています。</span>
<span class="hljs-comment">// マットの上にいる間、自動更新されます。</span>
<span class="hljs-comment">// コールバック機能：standardIdCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> x { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// マット上のコアキューブのY座標</span>
<span class="hljs-comment">// コアキューブの中心位置を基準とした座標となっています。</span>
<span class="hljs-comment">// マットの上にいる間、自動更新されます。</span>
<span class="hljs-comment">// コールバック機能：standardIdCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> y { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// マット上のコアキューブのXY座標</span>
<span class="hljs-comment">// コアキューブの中心位置を基準とした座標となっています。</span>
<span class="hljs-comment">// マットの上にいる間、自動更新されます。</span>
<span class="hljs-comment">// コールバック機能：standardIdCallback</span>
<span class="hljs-keyword">public</span> Vector2 pos { <span class="hljs-keyword">get</span>; }

<span class="hljs-comment">// マット上のコアキューブの角度</span>
<span class="hljs-comment">// コアキューブの中心位置を基準とした角度になっています。</span>
<span class="hljs-comment">// マットの上にいる間、自動更新されます。</span>
<span class="hljs-comment">// コールバック機能：standardIdCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> angle { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// マット上のコアキューブのXY座標</span>
<span class="hljs-comment">// コアキューブの光学センサー位置を基準とした座標になっています。</span>
<span class="hljs-comment">// マットの上にいる間、自動更新されます。</span>
<span class="hljs-comment">// コールバック機能：standardIdCallback</span>
<span class="hljs-keyword">public</span> Vector2 sensorPos { <span class="hljs-keyword">get</span>; }

<span class="hljs-comment">// マット上のコアキューブの角度</span>
<span class="hljs-comment">// コアキューブの光学センサー位置を基準とした角度になっています。</span>
<span class="hljs-comment">// マットの上にいる間、自動更新されます。</span>
<span class="hljs-comment">// コールバック機能：standardIdCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> sensorAngle { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// 読み取り可能な特殊ステッカーのID</span>
<span class="hljs-comment">// コアキューブの光学センサーから取得したIDとなっています。</span>
<span class="hljs-comment">// コールバック機能：standardIdCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">uint</span> standardId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// コアキューブのボタン押下状態の変数</span>
<span class="hljs-comment">// コールバック機能：buttonCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> isPressed { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// コアキューブの傾き状態の変数</span>
<span class="hljs-comment">// コールバック機能：slopeCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> isSloped { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// コアキューブの衝突状態の変数</span>
<span class="hljs-comment">// 内部実装は継承クラスによって大きく異なる可能性があります。</span>
<span class="hljs-comment">// コールバック機能：collisionCallback</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> isCollisionDetected { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// コアキューブがマット上にいるか判定する変数</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> isGrounded { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

<span class="hljs-comment">// コアキューブの最高速度を表す変数</span>
<span class="hljs-comment">// ファームウェアバージョン毎に異なるため用意されています。</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> maxSpd { <span class="hljs-keyword">get</span>; }</code></pre><br>

<h2 id="32-コールバック">3.2. コールバック</h2>
<pre><code class="hljs C#"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CallbackProvider</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddListener</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> key, Action&lt;Cube&gt; listener</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RemoveListener</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> key</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ClearListener</span>(<span class="hljs-params"></span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Notify</span>(<span class="hljs-params">Cube target</span>)</span>;
}

<span class="hljs-comment">// ボタンコールバック</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> CallbackProvider buttonCallback { <span class="hljs-keyword">get</span>; }
<span class="hljs-comment">// 傾きコールバック</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> CallbackProvider slopeCallback { <span class="hljs-keyword">get</span>; }
<span class="hljs-comment">// 衝突コールバック</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> CallbackProvider collisionCallback { <span class="hljs-keyword">get</span>; }
<span class="hljs-comment">// 座標角度コールバック</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> CallbackProvider idCallback { <span class="hljs-keyword">get</span>; }
<span class="hljs-comment">// StandardIDコールバック</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> CallbackProvider standardIdCallback { <span class="hljs-keyword">get</span>; }</code></pre><h2 id="33-メソッド">3.3. メソッド</h2>
<h3 id="move">Move</h3>
<pre><code class="hljs C#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Move</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> durationMs, ORDER_TYPE order=ORDER_TYPE.Weak</span>)</span>;</code></pre><p>キューブのモーターを制御します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_motor#%E6%99%82%E9%96%93%E6%8C%87%E5%AE%9A%E4%BB%98%E3%81%8D%E3%83%A2%E3%83%BC%E3%82%BF%E3%83%BC%E5%88%B6%E5%BE%A1">コアキューブ通信仕様</a></p>
<ul>
<li>left<ul>
<li>定義 : 左モーター速度</li>
<li>範囲 :<ul>
<li>[Version 2.0.0] -100 ~ -10； -9 ~ 9 は 0 に等価； 10 ~ 100</li>
<li>[Version 2.1.0] -115 ~ -8； -7 ~ 7 は 0 に等価； 8 ~ 115</li>
</ul>
</li>
</ul>
</li>
<li>right<ul>
<li>定義 : 右モーター速度</li>
<li>範囲 :<ul>
<li>[Version 2.0.0] -100 ~ -10； -9 ~ 9 は 0 に等価； 10 ~ 100</li>
<li>[Version 2.1.0] -115 ~ -8； -7 ~ 7 は 0 に等価； 8 ~ 115</li>
</ul>
</li>
</ul>
</li>
<li>durationMs<ul>
<li>定義 : 持続時間(ミリ秒)</li>
<li>範囲 :<ul>
<li>0~9 : 時間制限なし</li>
<li>10~2550 : 精度は 10ms、1 位が省略される</li>
</ul>
</li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="turnledon">TurnLedOn</h3>
<pre><code class="hljs C#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TurnLedOn</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> red, <span class="hljs-keyword">int</span> green, <span class="hljs-keyword">int</span> blue, <span class="hljs-keyword">int</span> durationMs, ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><p>キューブ底面についている LED を制御します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_light#%E7%82%B9%E7%81%AF-%E6%B6%88%E7%81%AF">コアキューブ通信仕様</a></p>
<ul>
<li>red<ul>
<li>定義 : 赤色の強さ</li>
<li>範囲 : 0~255</li>
</ul>
</li>
<li>green<ul>
<li>定義 : 緑色の強さ</li>
<li>範囲 : 0~255</li>
</ul>
</li>
<li>blue<ul>
<li>定義 : 青色の強さ</li>
<li>範囲 : 0~255</li>
</ul>
</li>
<li>durationMs<ul>
<li>定義 : 持続時間(ミリ秒)</li>
<li>範囲 :<ul>
<li>0~9 : 時間制限なし</li>
<li>10~2550 : 精度は 10ms、1 位が省略される</li>
</ul>
</li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="turnonlightwithscenario">TurnOnLightWithScenario</h3>
<pre><code class="hljs C#"><span class="hljs-comment">// 発光ごとの設定構造体</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> LightOperation
{
    <span class="hljs-keyword">public</span> Int16 durationMs; <span class="hljs-comment">// ミリ秒</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span> red;         <span class="hljs-comment">// 赤色の強さ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span> green;       <span class="hljs-comment">// 緑色の強さ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span> blue;        <span class="hljs-comment">// 青色の強さ</span>
}
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TurnOnLightWithScenario</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> repeatCount, Cube.LightOperation[] operations, ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><p>キューブ底面についている LED を連続的に制御します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_light#%E9%80%A3%E7%B6%9A%E7%9A%84%E3%81%AA%E7%82%B9%E7%81%AF-%E6%B6%88%E7%81%AF">コアキューブ通信仕様</a></p>
<ul>
<li>repeatCount<ul>
<li>定義 : 繰り返し回数</li>
<li>範囲 : 0~255</li>
</ul>
</li>
<li>operations<ul>
<li>定義 : 命令配列</li>
<li>個数 : 1~59</li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="turnledoff">TurnLedOff</h3>
<pre><code class="hljs C#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TurnLedOff</span>(<span class="hljs-params">ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><p>キューブ底面についている LED を消灯させます<br>
<a href="https://toio.github.io/toio-spec/docs/ble_light#%E5%85%A8%E3%81%A6%E3%81%AE%E3%83%A9%E3%83%B3%E3%83%97%E3%82%92%E6%B6%88%E7%81%AF">コアキューブ通信仕様</a></p>
<ul>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="playpresetsound">PlayPresetSound</h3>
<pre><code class="hljs C#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlayPresetSound</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> soundId, <span class="hljs-keyword">int</span> volume=<span class="hljs-number">255</span>, ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><p>キューブからあらかじめ用意された効果音を再生します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_sound#%E5%8A%B9%E6%9E%9C%E9%9F%B3%E3%81%AE%E5%86%8D%E7%94%9F">コアキューブ通信仕様</a></p>
<ul>
<li>soundId<ul>
<li>定義 : サウンド ID</li>
<li>範囲 : 0~10</li>
</ul>
</li>
<li>volume:<ul>
<li>定義 : 音量</li>
<li>範囲 : 0~255</li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="playsound">PlaySound</h3>
<p>キューブから任意の音を再生します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_sound#midi-note-number-%E3%81%AE%E5%86%8D%E7%94%9F">コアキューブ通信仕様</a></p>
<pre><code class="hljs C#"><span class="hljs-comment">// 引数版</span>
<span class="hljs-comment">// 発音ごとの設定構造体</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> SoundOperation
{
    <span class="hljs-keyword">public</span> Int16 durationMs; <span class="hljs-comment">// ミリ秒</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span> volume;      <span class="hljs-comment">// 音量(0~255)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span> note_number; <span class="hljs-comment">// 音符(0~128)</span>
}
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> repeatCount, SoundOperation[] operations, ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><ul>
<li>repeatCount<ul>
<li>定義 : 繰り返し回数</li>
<li>範囲 : 0~255</li>
</ul>
</li>
<li>operations<ul>
<li>定義 : 命令配列</li>
<li>個数 : 1~29</li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<pre><code class="hljs C#"><span class="hljs-comment">// バッファ版</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlaySound</span>(<span class="hljs-params"><span class="hljs-keyword">byte</span>[] buff, ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><ul>
<li>buff<ul>
<li>定義 : 命令プロコトル</li>
<li><a href="https://toio.github.io/toio-spec/docs/ble_sound#midi-note-number-%E3%81%AE%E5%86%8D%E7%94%9F">コアキューブ通信仕様</a></li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="stopsound">StopSound</h3>
<pre><code class="hljs C#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">StopSound</span>(<span class="hljs-params">ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><p>キューブの音再生を停止します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_sound#%E5%86%8D%E7%94%9F%E3%81%AE%E5%81%9C%E6%AD%A2">コアキューブ通信仕様</a></p>
<ul>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="configslopethreshold">ConfigSlopeThreshold</h3>
<pre><code class="hljs C#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigSlopeThreshold</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> angle, ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><p>キューブの水平検出のしきい値を設定します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_configuration#%E6%B0%B4%E5%B9%B3%E6%A4%9C%E5%87%BA%E3%81%AE%E3%81%97%E3%81%8D%E3%81%84%E5%80%A4%E8%A8%AD%E5%AE%9A">コアキューブ通信仕様</a></p>
<ul>
<li>angle<ul>
<li>定義 : 傾き検知の閾値</li>
<li>範囲 : 1~10</li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>

<h3 id="configcollisionthreshold">ConfigCollisionThreshold</h3>
<pre><code class="hljs C#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigCollisionThreshold</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> level, ORDER_TYPE order=ORDER_TYPE.Strong</span>)</span>;</code></pre><p>キューブの衝突検出のしきい値を設定します<br>
<a href="https://toio.github.io/toio-spec/docs/ble_configuration#%E8%A1%9D%E7%AA%81%E6%A4%9C%E5%87%BA%E3%81%AE%E3%81%97%E3%81%8D%E3%81%84%E5%80%A4%E8%A8%AD%E5%AE%9A">コアキューブ通信仕様</a></p>
<ul>
<li>level<ul>
<li>定義 : 衝突検知の閾値</li>
<li>範囲 : 1~10</li>
</ul>
</li>
<li>order<ul>
<li>定義 : <a href="sys_cube.html#4-%E5%91%BD%E4%BB%A4%E9%80%81%E4%BF%A1">命令の優先度</a></li>
<li>種類 : Weak, Strong</li>
</ul>
</li>
</ul>
<br>



</body></html>
