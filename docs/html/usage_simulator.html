<!DOCTYPE html><html><head><meta charset="utf-8"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css"><style type="text/css">.markdown-body {padding: 20px 40px;}</style><style type="text/css">/*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
}

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold;
}

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080;
}

.hljs-string,
.hljs-doctag {
  color: #d14;
}

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold;
}

.hljs-subst {
  font-weight: normal;
}

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
}

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal;
}

.hljs-regexp,
.hljs-link {
  color: #009926;
}

.hljs-symbol,
.hljs-bullet {
  color: #990073;
}

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3;
}

.hljs-meta {
  color: #999;
  font-weight: bold;
}

.hljs-deletion {
  background: #fdd;
}

.hljs-addition {
  background: #dfd;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
/*# sourceURL=/Users/yaeda/.nodebrew/node/v14.3.0/lib/node_modules/md-to-pdf/node_modules/highlight.js/styles/github.css*/</style></head>
<body class="markdown-body">
<h1 id="目次">目次</h1>
<ul>
<li><a href="usage_simulator.html#1-%E6%A6%82%E8%AA%AC">1. 概説</a></li>
<li><a href="usage_simulator.html#2-Mat-Prefab">2. Mat Prefab</a><ul>
<li><a href="usage_simulator.html#21-Inspector-%E3%81%A7%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC">2.1. Inspector でのパラメーター</a></li>
<li><a href="usage_simulator.html#22-%E5%AE%9A%E6%95%B0">2.2. 定数</a></li>
<li><a href="usage_simulator.html#23-%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89">2.3. メソッド</a></li>
</ul>
</li>
<li><a href="usage_simulator.html#3-Cube-Prefab">3. Cube Prefab</a><ul>
<li><a href="usage_simulator.html#31-Inspector-%E3%81%A7%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC">3.1. Inspector でのパラメーター</a></li>
<li><a href="usage_simulator.html#32-%E5%AE%9A%E6%95%B0">3.2. 定数</a></li>
<li><a href="usage_simulator.html#33-%E5%A4%89%E6%95%B0">3.3. 変数</a></li>
<li><a href="usage_simulator.html#34-%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89">3.4. メソッド</a></li>
</ul>
</li>
<li><a href="usage_simulator.html#4-Stage-Prefab">4. Stage-Prefab</a><ul>
<li><a href="usage_simulator.html#41-%E3%82%BF%E3%83%BC%E3%82%B2%E3%83%83%E3%83%88%E3%83%9D%E3%83%BC%E3%83%AB">4.1. ターゲットポール</a></li>
<li><a href="usage_simulator.html#42-%E3%82%AD%E3%83%A5%E3%83%BC%E3%83%96%E3%82%92%E3%83%95%E3%82%A9%E3%83%BC%E3%82%AB%E3%82%B9">4.2. キューブをフォーカス</a></li>
</ul>
</li>
</ul>
<h1 id="1-概説">1. 概説</h1>
<p>Simulator は、toio コアキューブと通信するスマホアプリを開発する際、 Unity Editor 上で手軽に動作チェックができるように作られた仮想環境です。</p>
<p>Simulator は Assets/toio-sdk/Scripts/Simulator/Resources/ の下にある、以下の 3 つの prefab から構成されています。</p>
<ul>
<li>Mat 　… トイオ・コレクションに付属するマットを模したもの</li>
<li>Cube 　… toio のコアキューブを模したもの</li>
<li>Stage 　… シミュレーション環境に必要な一通りの機能をセットにしたもの</li>
</ul>
<p>Simulator に実装されたクラスは皆ネームスペース <code>toio.Simulator</code> にあります。</p>
<h1 id="2-mat-prefab">2. Mat Prefab</h1>
<p>Mat Prefab はトイオ・コレクションに付属するマットを模したゲームオブジェクトです。</p>
<p>Cube Prefab は Mat に置くと、 Mat の座標位置と方向を取得することが出来ます。</p>
<p>Mat Prefab はシーンの中に複数枚、水平であれば位置と角度任意で置けます。</p>
<h2 id="21-inspector-でのパラメーター">2.1. Inspector でのパラメーター</h2>
<div align="center"><img width="300" src="../res/usage_simulator/mat.png"></div>

<p>Unity の Inspector で、スクリプト Mat.cs のパブリック変数 Mat Type に、</p>
<ul>
<li>Main Front</li>
<li>Main Back</li>
<li>Custom</li>
</ul>
<p>のいずれかを選択すると、マットの見た目と座標を変えられます。</p>
<h2 id="22-定数">2.2. 定数</h2>
<pre><code class="hljs c#"><span class="hljs-comment">// マット単位とメートルの比例</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> DotPerM = <span class="hljs-number">411f</span>/<span class="hljs-number">0.560f</span>; <span class="hljs-comment">// (410+1)/0.560 dot/m</span></code></pre><h2 id="23-メソッド">2.3. メソッド</h2>
<h3 id="unitydeg2matdeg">UnityDeg2MatDeg</h3>
<pre><code class="hljs c#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">UnityDeg2MatDeg</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> degU</span>)</span>;</code></pre><p>Unity 上の角度を本マット上の角度に変換します</p>
<ul>
<li>degU<ul>
<li>定義：Unity 上の角度（度）</li>
<li>範囲：任意</li>
</ul>
</li>
<li>戻り値<ul>
<li>定義：本マット上の角度（度）</li>
</ul>
</li>
</ul>
<h3 id="matdeg2unitydeg">MatDeg2UnityDeg</h3>
<pre><code class="hljs c#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> <span class="hljs-title">MatDeg2UnityDeg</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> degM</span>)</span>;</code></pre><p>本マット上の角度を Unity 上の角度に変換します</p>
<ul>
<li>degM<ul>
<li>定義：本マット上の角度（度）</li>
<li>範囲：任意</li>
</ul>
</li>
<li>戻り値<ul>
<li>定義：Unity 上の角度（度）</li>
</ul>
</li>
</ul>
<h3 id="unitycoord2matcoord">UnityCoord2MatCoord</h3>
<pre><code class="hljs c#"><span class="hljs-function"><span class="hljs-keyword">public</span> Vector2Int <span class="hljs-title">UnityCoord2MatCoord</span>(<span class="hljs-params">Vector3 unityCoord</span>)</span>;</code></pre><p>Unity の 3D 空間座標から、本マットにおけるマット座標に変換します</p>
<ul>
<li>unityCoord<ul>
<li>定義：Unity 上の座標</li>
<li>範囲：任意</li>
</ul>
</li>
<li>戻り値<ul>
<li>定義：本マット上の座標</li>
</ul>
</li>
</ul>
<h3 id="matcoord2unitycoord">MatCoord2UnityCoord</h3>
<pre><code class="hljs c#"><span class="hljs-function"><span class="hljs-keyword">public</span> Vector3 <span class="hljs-title">MatCoord2UnityCoord</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> x, <span class="hljs-keyword">double</span> y</span>)</span>;</code></pre><p>本マットにおけるマット座標から、Unity の 3D 空間座標に変換します</p>
<ul>
<li>x<ul>
<li>定義：本マット上のｘ座標</li>
<li>範囲：任意</li>
</ul>
</li>
<li>y<ul>
<li>定義：本マット上のｙ座標</li>
<li>範囲：任意</li>
</ul>
</li>
<li>戻り値<ul>
<li>定義：Unity 上の 3D 座標</li>
</ul>
</li>
</ul>
<h1 id="3-cube-prefab">3. Cube Prefab</h1>
<p>Cube Prefab は toio のコアキューブを模したゲームオブジェクトです。</p>
<p>実際のコアキューブとは一部機能差があります。<br>
詳細については、<a href="usage_cube.html#RealSim%E6%A9%9F%E8%83%BD%E8%A1%A8">機能の対応状況</a>を参考にしてください。</p>
<p>Cube Prefab はシーンの中に複数台配置することが出来ます。 ( Cube Prefab が他のオブジェクトと重ならないように配置してください。 )</p>
<h2 id="31-inspector-でのパラメーター">3.1. Inspector でのパラメーター</h2>
<div align="center"><img width="300" src="../res/usage_simulator/cube.png"></div>

<p>Inspector から操作できるパラメーターは以下の 3 つです。</p>
<ul>
<li>MOTOR_TAU： モーターの一次遅れ要素のパラメーター</li>
<li>Delay： 通信の遅延(指令の送信から取得した座標が変わるまでのラグ)</li>
<li>バージョン： ファームウェアのバージョン情報</li>
</ul>
<h2 id="32-定数">3.2. 定数</h2>
<pre><code class="hljs c#"><span class="hljs-comment">// 左右タイヤの間隔（メートル）</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> TireWidthM = <span class="hljs-number">0.0266f</span>;
<span class="hljs-comment">// 左右タイヤの間隔（ドット（マット座標））</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> TireWidthDot= <span class="hljs-number">0.0266f</span> * Mat.DotPerM;
<span class="hljs-comment">// キューブのサイズ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> WidthM= <span class="hljs-number">0.0318f</span>;
<span class="hljs-comment">// 速度（ドット毎秒）と指示値の比例</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">float</span> VDotOverU =  <span class="hljs-number">4.3f</span>*Mathf.PI*<span class="hljs-number">0.0125f</span>/<span class="hljs-number">60</span> * Mat.DotPerM; <span class="hljs-comment">// about 2.06</span></code></pre><h2 id="33-変数">3.3. 変数</h2>
<pre><code class="hljs c#"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> x { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }        <span class="hljs-comment">// マット上のｘ座標</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> y { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }        <span class="hljs-comment">// マット上のｙ座標</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">float</span> deg { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }    <span class="hljs-comment">// マット上の角度（度）</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> offMat { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }  <span class="hljs-comment">// マットから離れているか</span>
<span class="hljs-keyword">public</span> Mat mat { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }      <span class="hljs-comment">// 置かれているマット</span></code></pre><h2 id="34-メソッド">3.4. メソッド</h2>
<p>Cube クラスから利用するためのメソッドなので、エンドユーザーが直に使う必要がありません。</p>
<h1 id="4-stage-prefab">4. Stage Prefab</h1>
<p>Stage Prefab は、</p>
<ul>
<li>Mat Prefab</li>
<li>カメラ</li>
<li>ライト</li>
<li>ターゲットポール (後述)</li>
<li>キューブの脱出を防止する 「テーブル」 と ボーダー</li>
</ul>
<p>をセットにしたものです。</p>
<p>また、Stage Prefab は以下の 2 つの便利なツールを備えています。</p>
<ul>
<li>ターゲットポール</li>
<li>キューブをフォーカスする</li>
</ul>
<h2 id="41-ターゲットポール">4.1. ターゲットポール</h2>
<p>ターゲットポールは、 Stage Prefab の中央にあるピンク色の棒です。</p>
<div align="center"><img width="150" src="../res/usage_simulator/targetPole.png"></div>

<p>マウスの左クリックまたはドラッグすることで ターゲットポールを移動することができ、
開発者はターゲットポールの位置を取得してキューブの制御に利用することが出来ます。</p>
<pre><code class="hljs c#"><span class="hljs-keyword">public</span> Vector2Int targetPoleCoord { <span class="hljs-keyword">get</span>; } <span class="hljs-comment">// ターゲットポールのマット座標を取得</span></code></pre><p>ターゲットポールを使ってキューブを操作する具体的な方法については <a href="tutorials_cubehandle.html#Follow-TargetPole-%E3%83%87%E3%83%A2">チュートリアル</a> で紹介しています。</p>
<h2 id="42-キューブをフォーカス">4.2. キューブをフォーカス</h2>
<p>キューブを右クリックすると、フォーカスされます。<br>
キューブ以外を右クリックすると、フォーカスが外れます。</p>
<div align="center"><img width="250" src="../res/usage_simulator/focus.png"></div>

<p>フォーカスの対象を取得することで、特定のキューブの操作やデバッグが容易になります。</p>
<h3 id="プロパティ">プロパティ</h3>
<pre><code class="hljs c#"><span class="hljs-comment">// フォーカス対象の名前（Unityヒエラルキーでの名前）</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> focusName { <span class="hljs-keyword">get</span>; }</code></pre><h3 id="setfocus">SetFocus</h3>
<pre><code class="hljs c#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetFocus</span>(<span class="hljs-params">Transform transform</span>)</span>;</code></pre><p>手動でフォーカス対象を設定します</p>
<ul>
<li>transform<ul>
<li>定義：フォーカスの対象</li>
</ul>
</li>
</ul>
<h3 id="setnofocus">SetNoFocus</h3>
<pre><code class="hljs c#"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetNoFocus</span>(<span class="hljs-params"></span>)</span>;</code></pre><p>フォーカスをキャンセルします</p>



</body></html>
